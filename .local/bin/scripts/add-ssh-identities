#!/usr/bin/env sh

# script to add ssh-keys
main () {
    # add ssh keys
    PEM_KEY_PATH="$HOME/.ssh/*.pem"
    RSA_KEY_PATH="$HOME/.ssh/*_rsa"

    # if ~/.ssh has any files matching *.pem, add them all.
    if test "$(echo "$PEM_KEY_PATH" | wc -w)" -gt 0; then
        # add all *.pem files, and silence the output.
        # shellcheck disable=SC2086
        # ssh-add $PEM_KEY_PATH >/dev/null 2>&1
        ssh-add $PEM_KEY_PATH >/dev/null 2>&1

        # if command fails, echo to STDOUT, because prevous command was silenced.
        if test $? -ne 0; then
            echo "ssh-adding .pem files failed. check manually."
        fi
    fi

    # if ~/.ssh has any files matching *_rsa, add them all.
    if test "$(echo "$RSA_KEY_PATH" | wc -w)" -gt 0; then
        # add all *_rsa files, and silence the output.
        # shellcheck disable=SC2086
        # ssh-add $RSA_KEY_PATH >/dev/null 2>&1
        ssh-add $RSA_KEY_PATH >/dev/null 2>&1

        # if command fails, echo to STDOUT, because prevous command was silenced.
        if test $? -ne 0; then
            echo "ssh-adding _rsa files failed. check manually."
        fi
    fi
}

main

